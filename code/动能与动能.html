<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>能量守恒动画</title>
  <style>
    canvas {
      border: 1px solid black;
    }
    .input-container {
      margin-top: 0px;
    }
    label, input, button {
      display: block;
      margin-bottom: 10px;
    }
    a {
      color: #0366d6;
      text-decoration: none;
      border: 1px solid #0366d6;
      padding: 5px 10px;
      font-family: 'Comic Sans MS', cursive;
      margin-right: 20px; /* 设置右侧边距 */
      display: inline-block; /* 设置为行内块元素 */
      }
    a:hover {
      text-decoration: underline;
    }
    
  </style>
</head>
<body>
    <a href="主页面.html">返回</a>
  <div class="input-container">
    <canvas id="myCanvas" width="600" height="400"></canvas>
    <label for="mass1">物体1质量:</label>
    <input type="number" id="mass1" value="1">
    <label for="velocity1">物体1速度:</label>
    <input type="number" id="velocity1" value="5">

    <label for="mass2">物体2质量:</label>
    <input type="number" id="mass2" value="2">
    <label for="velocity2">物体2速度:</label>
    <input type="number" id="velocity2" value="0">

    <button onclick="startAnimation()">开始动画</button>
    <button onclick="resetAnimation()">复位</button>
    <button id="pauseButton" onclick="pauseResumeAnimation()">暂停</button>

  </div>

  <script>
    const canvas = document.getElementById('myCanvas');
    const ctx = canvas.getContext('2d');
    let animationId;
    let isPaused = false;

    let obj1 = {
      mass: parseFloat(document.getElementById('mass1').value),
      velocity: parseFloat(document.getElementById('velocity1').value),
      x: 100,
      radius: 20
    };

    let obj2 = {
      mass: parseFloat(document.getElementById('mass2').value),
      velocity: parseFloat(document.getElementById('velocity2').value),
      x: canvas.width - 100,
      radius: 30
    };

    function startAnimation() {
      obj1.mass = parseFloat(document.getElementById('mass1').value);
      obj1.velocity = parseFloat(document.getElementById('velocity1').value);
      obj2.mass = parseFloat(document.getElementById('mass2').value);
      obj2.velocity = parseFloat(document.getElementById('velocity2').value);

      isPaused = false;
      animationId = requestAnimationFrame(animate);
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // 更新物体位置
      obj1.x += obj1.velocity;
      obj2.x += obj2.velocity;

      // 边界检测和弹回
      if (obj1.x + obj1.radius >= canvas.width || obj1.x - obj1.radius <= 0) {
        obj1.velocity *= -1;
      }
      if (obj2.x + obj2.radius >= canvas.width || obj2.x - obj2.radius <= 0) {
        obj2.velocity *= -1;
      }

      // 绘制物体
      ctx.fillStyle = 'blue';
      ctx.beginPath();
      ctx.arc(obj1.x, canvas.height / 2, obj1.radius, 0, Math.PI * 2);
      ctx.fill();

      ctx.fillStyle = 'red';
      ctx.beginPath();
      ctx.arc(obj2.x, canvas.height / 2, obj2.radius, 0, Math.PI * 2);
      ctx.fill();

      // 检测碰撞
      if (obj1.x + obj1.radius >= obj2.x - obj2.radius) {
        const v1f = ((obj1.mass - obj2.mass) * obj1.velocity + 2 * obj2.mass * obj2.velocity) / (obj1.mass + obj2.mass);
        const v2f = ((obj2.mass - obj1.mass) * obj2.velocity + 2 * obj1.mass * obj1.velocity) / (obj1.mass + obj2.mass);
        obj1.velocity = v1f;
        obj2.velocity = v2f;
      }

      if (!isPaused) {
        animationId = requestAnimationFrame(animate);
      }
    }

    function resetAnimation() {
      cancelAnimationFrame(animationId);
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      obj1.x = 100;
      ctx.fillStyle = 'blue';
      ctx.beginPath();
      ctx.arc(obj1.x, canvas.height / 2, obj1.radius, 0, Math.PI * 2);
      ctx.fill();

      obj2.x = canvas.width - 100;
      ctx.fillStyle = 'red';
      ctx.beginPath();
      ctx.arc(obj2.x, canvas.height / 2, obj2.radius, 0, Math.PI * 2);
      ctx.fill();
    }

    function pauseResumeAnimation() {
      if (isPaused) {
        document.getElementById('pauseButton').innerText = '暂停';
        isPaused = false;
        animate();
      } else {
        document.getElementById('pauseButton').innerText = '继续';
        isPaused = true;
      }
    }
  </script>
</body>
</html>
